<section class="section">
  <div class="section-header">
    <div class="row m-0">
      <h1 class="mr-3">Data Lomba</h1>
      <a href="jenisLomba" class="btn btn-primary text-white mr-3"> Tambah Jenis Lomba</a>
      <a href="bidangLomba" class="btn btn-primary text-white"> Tambah Bidang Lomba</a>
    </div>
  </div>

  <div class="section-body">
    <div class="card">
      <div class="card-body">
        <div class="row">
          <div class="col-12">
            <div class="table-responsive">
              <table id="myTable" class="table">
                <thead>
                  <tr>
                    <th>No.</th>
                    <th>Gambar</th>
                    <th>Nama Lomba</th>
                    <th>Deskripsi</th>
                    <th>Tanggal</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <% var no=1; kategoriLomba.forEach((data)=> {
                    if (data.gambar!==""){ var gambar = data.gambar;}
                    else {var gambar = "default.png";}
                    %>
                    <tr>
                      <td class="text-center">
                        <%= no %>
                      </td>
                      <td>
                        <img src="/assets/img/jenisLomba/<%= gambar %>" class="thumbnail-table">
                      </td>
                      <td>
                        <%= data.nama_lomba %>
                      </td>
                      <td>
                        <%= data.desk %>
                      </td>
                      <td style="width: 100px;">
                        <%= data.tanggal %>
                      </td>
                      <td align="center" style="width: 90px;">
                        <button type="button" class="btn btn-table btn-sm btn-primary" title="Edit" data-toggle="modal"
                          data-target="#editLomba" onclick='editLomba("<%= data.id %>")'>
                          <i class="fa fa-pen"></i>
                        </button>
                        <button type="button" class="btn btn-table btn-sm btn-primary" title="Gambar"
                          data-toggle="modal" data-target="#gambarLomba" onclick='gambarLomba("<%= data.id %>")'>
                          <i class="fa fa-camera"></i></button>
                        <p id="<%= data.id %>" class="d-none">
                          <%= data.nama_lomba %>
                        </p>
                        <button type="button" class="btn btn-table btn-sm btn-danger" id="swal-6" title="Hapus" data-toggle="modal"
                          data-target="#hapusLomba" onclick='hapusLomba("<%= data.id %>")'>
                          <i class="fa fa-times"></i></button>
                      </td>
                    </tr>
                    <% no++; }) %>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<div class="modal fade" id="editLomba" tabindex="-1" role="dialog" style="display: none;" aria-modal="true">
  <div class="modal-dialog modal-dialog-centered modal-md" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title"><i class="fa fa-pen"></i>Edit Lomba</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">×</span>
        </button>
      </div>
      <hr>
      <div class="modal-body">
        <form class="forms-sample" method="post">
          <div class="form-group">
            <input type="hidden" class="d-none" id="eId" name="id" required>
            <center>
              <p for="buku">Manakah yang ingin anda edit ?</p><br>
              <button type="submit" id="editJenis" class="btn btn-primary text-white mr-2" name="submit" value="jenis">
                Edit Jenis Lomba
              </button>
              <button type="submit" id="editJenis" class="btn btn-primary text-white mr-2" name="submit" value="edit">
                Edit Bidang Lomba
              </button>
            </center>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>


<div class="modal fade" id="gambarLomba" tabindex="-1" role="dialog" style="display: none;" aria-modal="true">
  <div class="modal-dialog modal-md" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title"><i class="fa fa-pen"></i> Edit Gambar Lomba</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">×</span>
        </button>
      </div>
      <hr>
      <div class="modal-body">
        <form class="forms-sample" method="post" enctype="multipart/form-data">
          <div class="form-group">
            <input type="hidden" class="d-none" id="gId" name="id_lomba" required>
            <p for="gambar">Upload foto :</p>
            <input type="file" class="form-control" id="gambar" name="gambar" required style="height: auto">
          </div>
          <hr>
          <div class="modal-footer p-0 pt-3">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
            <button type="submit" class="btn btn-primary btn-shadow" name="submit" value="gambar"><i
                class="fa fa-save"></i><span> Simpan</span></button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="hapusLomba" tabindex="-1" role="dialog" style="display: none;" aria-modal="true">
  <div class="modal-dialog modal-md" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title"><i class="fa fa-times"></i> Hapus Data Lomba</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">×</span>
        </button>
      </div>
      <hr>
      <div class="modal-body">
        <form class="forms-sample" method="post">
          <div class="form-group">
            <p id="dHapus">Apakah anda yakin ingin menghapus Lomba ini ?</p>
            <input type="hidden" class="d-none" class="form-control" id="dId" name="id_lomba" value="" required>
          </div>
          <hr>
          <div class="modal-footer p-0 pt-3">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
            <button type="submit" class="btn btn-danger btn-shadow" name="submit" value="hapus"><i
                class="fa fa-times"></i><span> Hapus</span></button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">

  function editLomba(idLomba) {
    var dataLomba = (document.getElementById(idLomba).textContent).split(",");
    document.getElementById("eId").value = idLomba;
  }

  function hapusLomba(idLomba) {
    var dataLomba = (document.getElementById(idLomba).textContent).split(",");
    document.getElementById("dId").value = idLomba;
    document.getElementById("dHapus").textContent = 'Apakah anda yakin ingin menghapus "' + dataLomba[0] + '"?';
  }

  function gambarLomba(idLomba) {
    var dataLomba = (document.getElementById(idLomba).textContent).split(",");
    document.getElementById("gId").value = idLomba;
  }

</script>